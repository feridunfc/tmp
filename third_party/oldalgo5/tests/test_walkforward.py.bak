from ui.services import sdk
from algo3.core.backtest.walkforward import run_walkforward
from algo3.core.strategies.ma_crossover import MACrossover
def test_walkforward_basic():
    df = sdk.load_data("AAPL", "1d")
    grid = {"short_window":[5,10], "long_window":[20,30]}
    res = run_walkforward(MACrossover, df, grid, n_splits=3, backtest_fn=sdk.run_backtest_with_signals, commission=0.0001, slippage=0.0001, capital=100000.0)
    assert not res.empty
